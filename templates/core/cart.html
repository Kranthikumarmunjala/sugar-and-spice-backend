{% extends 'core/base.html' %}
{% load static %}

{% block title %}{% if site_config %}{{ site_config.logo_title }}{% endif %} - My Cart{% endblock title %}

{% block content %}
<main>
    <div class="cart-page-container">
        <div class="cart-items-column">
            <h2 class="page-title">My Cart</h2>
            
            <!-- This container no longer has an ID, so main.js won't interfere with it -->
            <div class="cart-items-list">
                {% if cart_items %}
                    {% for item in cart_items %}
                    <div class="full-cart-item">
                        <img src="{% if item.item.image %}{{ item.item.image.url }}{% else %}{% static 'path/to/default/image.png' %}{% endif %}" alt="{{ item.item.name }}">
                        
                        <div class="item-info">
                            <p class="item-name">{{ item.item.name }}</p>
                            <p class="item-price">${{ item.item.price }}</p>
                        </div>
                        
                        <!-- NOTE: These quantity controls are for display only.
                             Making them functional requires more advanced JavaScript (AJAX). -->
                        <div class="quantity-control">
                            <button disabled style="cursor: default;">-</button>
                            <span>{{ item.quantity }}</span>
                            <button disabled style="cursor: default;">+</button>
                        </div>
                        
                        <!-- Display the line total calculated in the view -->
                        <div class="item-total-full">${{ item.line_total|floatformat:2 }}</div>
                        
                        <!-- NOTE: A functional remove button also requires AJAX. -->
                        <button disabled class="cart-item-remove-btn" style="cursor: default;"><i class="fa-solid fa-trash-can"></i></button>
                    </div>
                    {% endfor %}
                {% else %}
                    <p class="cart-empty-msg">Your cart is empty. <a href="{% url 'order-online' %}">Continue shopping</a>.</p>
                {% endif %}
            </div>
        </div>

        <div class="order-summary-column">
            <h2 class="page-title">Order Summary</h2>
            <div class="summary-details">
                <div class="summary-row">
                    <span>Subtotal</span>
                    <span id="summary-subtotal">${{ subtotal|floatformat:2 }}</span>
                </div>
                <hr>
                <div class="summary-row total-row">
                    <span>Total</span>
                    <span id="summary-total">${{ subtotal|floatformat:2 }}</span>
                </div>
            </div>
            
            {% if cart_items %}
                <!-- This link will now work correctly because JS is not interfering -->
                <a href="{% url 'checkout' %}" class="checkout-btn" style="text-align: center; display: block; text-decoration: none;">Checkout</a>
            {% else %}
                <button class="checkout-btn" disabled>Checkout</button>
            {% endif %}
            
            <p class="secure-checkout-text"><i class="fa-solid fa-lock"></i> Secure Checkout with Stripe</p>
        </div>
    </div>

    <div class="star-divider"></div>
</main>
{% endblock content %}